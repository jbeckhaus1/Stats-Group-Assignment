Cover Sheet
========================================================


By including this statement, we, all the students listed in the table
below, declare that:

- We hold a copy of this assignment if the original is lost or damaged.

- We hereby certify that no part of this assignment has been copied from
  any other student's work or from any other source except where due
  acknowledgement is made in the assignment.

- No part of the assignment has been written for us by any other person
  except where collaboration has been authorised by the unit coordinator.

- We are aware that this work may be reproduced and submitted to plagiarism
  detection software programs for the purpose of detecting possible
  plagiarism; this software may retain a copy on its database for future
  plagiarism checking.

- We hereby certify that no part of this assignment or product has been
  submitted by any of us in another (previous or current) assessment, except
  where appropriately referenced, and with prior permission from the unit
  coordinator for this unit.

- We hereby certify that we have read and understand what the University
  considers to be academic misconduct, and that we are aware of the
  penalties that may be imposed for academic misconduct.

Name               | Student Number | Contribution (%)
-------------------|----------------|-----------------
Rachel Hardie      |  18820821      |
Simon              |                |
Jack Beckhaus      |                |
                   |                |

<div style="page-break-before:always;"></div>


Group Project
========================================================

Explain the assignment.


This project uses Git for versioning

https://github.com/jbeckhaus1/Stats-Group-Assignment

https://github.com/rachelsoma/Stats-Group-Assignment


Part One - Load and clean up data
--------------------------------------------------------

Load and clean the data is the csv file

Some of the records (rows) in the data set are inconsistent, in that either the total species count does not equal
the sum of the counts for the three species, or the variable FlyingFoxesAbsent does not match the total count being
zero or not.
Remove inconsistent records from the data set.

```{r}
#load the data from csv
foxData = read.csv("FlyingFoxMonitoring.csv",header = TRUE)

#converting factor to integer
blkFox <- suppressWarnings(c(as.numeric(as.character(foxData$BlackFlyingFox.Count))))
redFox<- suppressWarnings(c(as.numeric(as.character(foxData$LittleRedFlyingFox.Count))))
greyFox<- suppressWarnings(c(as.numeric(as.character(foxData$GreyHeadedFlyingFox.Count))))
totalFox <- suppressWarnings(c(as.numeric(as.character(foxData$TotalSpecies.Count))))
camp <- (as.character(foxData$Camp))
ehpCamp<-foxData$EHP.CampId


#remove rows where variable FlyingFoxesAbsent does not match the total count being zero or not.

idHasFox=which(foxData$FlyingFoxesAbsent!=TRUE)
idHasNoFox=which(suppressWarnings(c(as.numeric(as.character(foxData$TotalSpecies.Count))))!=0)
illogicalFox=setdiff(idHasFox,idHasNoFox)

##removing data with NA

#make a vector of the rows which have missing data
idNA=c(which(is.na(blkFox)),which(is.na(redFox)),which(is.na(greyFox)),which(is.na(totalFox)),which(is.na(camp)),illogicalFox,which(is.na(ehpCamp)))
paste(length(idNA),"cases have NAs")

#remove those rows
blkFox=blkFox[-idNA]
redFox=redFox[-idNA]
greyFox=greyFox[-idNA]
totalFox=totalFox[-idNA]


#calculate totals based on each species
myTotal = blkFox+redFox+greyFox
diffTotals = totalFox-myTotal

#make a vector where if the difference between the actual total and the sum of each species doesn't match the value is NA and if it does it's "good"
idBadMath=ifelse(diffTotals!=0,NA,"good")
paste(sum(is.na(idBadMath)),"rows have totals that dont match the sum of each species")
#making a vecor of the NAs (which are actually the rows with bad maths)
idBadMath=which(is.na(idBadMath))


#removing the rows that have bad maths
blkFox=blkFox[-idBadMath]
redFox=redFox[-idBadMath]
greyFox=greyFox[-idBadMath]
totalFox=totalFox[-idBadMath]



dirty <-c(idNA,idBadMath)
camp=camp[-dirty]

ehpCamp=ehpCamp[-dirty]

```

Interpret the solution of the problem.

Part Two - Camp size
--------------------------------------------------------
(a) [2 marks] Analyse the distribution of the total camp size (TotalSpecies.Count) and the distribution of the
natural logarithm2 of the total camp size for non-empty camps.
Explain why the logarithm of the camp size is the more meaningful variable to consider.
```{r}
##natural logarithm of the total species count per camp
foxyCamps=which(foxData$FlyingFoxesAbsent!=TRUE)
foxyCamps=totalFox[foxyCamps]
log.CampSize=log(foxyCamps)
#paste(totalFox,logCampSize)
#logCampSize
foxyCamps.length=length(foxyCamps)

##histogram of camp size logarithm
hist(log.CampSize)
```


(b) [2 marks] Use bootstrapping to compute a 95% confidence interval for the mean logarithm of the total camp size for
non-empty camps.
Interpret your result.
```{r}

##boot strap of mean camp size logarithm
##Generating a Bootstrap Distribution
b = 10000
boot.dist = rep(NA, b)
for (i in 1:b) {
boot.sample = sample(foxyCamps, replace=TRUE)
boot.dist=log(boot.sample)
boot.dist[i]=mean(boot.dist, conf.level = 0.95)
sd(boot.dist)
}
hist(boot.dist)

```

Part Three - Species Proportions
--------------------------------------------------------

(a) [2 marks] Compute the proportions of each species at each camp site and visualise them. Then compute the overall
proportions of each species.
Discuss your results.

```{r}
#get number of factors
campFactor=nlevels(ehpCamp)
#create empty vector
foxPerCamp <- rep(NA, campFactor)
#fill vector using for loop
for(j in 1:as.numeric(campFactor)){
    foxPerCamp[j] <- c(sum(totalFox[ehpCamp==j]))
}

#visualising with a scatterplot
redblue <- colorRampPalette(c("red","blue"))
plot(foxPerCamp,xlab="Per Camp",ylab="Total Flying Foxes",col=redblue(5))

#proportion for whole species
blk=sum(blkFox)
red=sum(redFox)
grey=sum(greyFox)
foxProp=c(blk,red,grey)/sum(totalFox)*100

#visualise proportions with a bar plot
barplot(matrix(foxProp),beside=TRUE, col=grey.colors(3), ylim=c(0,100))

```

(b) [2 marks] Analyse whether the total camp size and the proportion of Little Red Flying Foxes are associated by
testing at a signifcance level of 1% whether whether there is evidence that the correlation between the total size of
a camp and the proportion of Little Red Flying Foxes in that camp is non-zero.
Interpret your results.

```{r}
redFox.3b=which(redFox>0)
totalFox.3b=totalFox[redFox.3b]
redFox.3b=redFox[redFox.3b]

cor.test(redFox.3b/totalFox.3b,totalFox.3b, alternative = "two.sided", conf.level = 0.99)

```
Part 4 - Camp size at Indooroopilly Island over time
--------------------------------------------------------
[2 marks] Use concepts related to linear regression to test at a signifcance level of 1% whether there is evidence that the number of fying foxes at the Indooroopilly Island camp (EHP CampId 68) has decreased over time.
Use the function as.Date to convert the date strings in the variable SurveyDate into dates. (Check the manual page
and make sure that you use the correct format string for the dd/mm/yy format used in the csv file!) If needed, you can
use the function as.numeric to convert the resulting date objects to a numeric value.

```{r}
#load and clean data

#Use the function as.Date to convert the date strings in the variable SurveyDate into dates. 
date <- suppressWarnings(c(as.Date(foxData$SurveyDate,"%d/%m/%y")))
date=date[-dirty]

#vector of id for Indooroopilly Island Camp
idIndoIsland=which(ehpCamp=="68")

#create vector of data and total fox count for Indooroopilly Island 
indoDates=date[idIndoIsland]
indoFox=totalFox[idIndoIsland]

# This is probably wrong
indo.lm=lm(indoFox ~ as.numeric(indoDates))

summary(indo.lm)

plot(indoFox~indoDates, col=redblue(5),xlab="Dates", ylab = "Num. FLying Foxes")
```

